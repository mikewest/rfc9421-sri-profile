



Network Working Group                                            M. West
Internet-Draft                                              Google, LLC.
Intended status: Informational                          21 November 2024
Expires: 25 May 2025


     An HTTP Message Signature Profile for Client-Side Verification
                draft-west-sri-signature-profile-latest

Abstract

   An HTTP Message Signature profile that specifies the requirements for
   signatures intended as proofs of integrity/provenance that can be
   enforced upon by clients without any pre-existing relationship to the
   server which delivered them.

About This Document

   This note is to be removed before publishing as an RFC.

   The latest revision of this draft can be found at
   https://mikewest.github.io/rfc9421-sri-profile/draft-west-sri-
   signature-profile.html.  Status information for this document may be
   found at https://datatracker.ietf.org/doc/draft-west-sri-signature-
   profile/.

   Source for this draft and an issue tracker can be found at
   https://github.com/mikewest/rfc9421-sri-profile.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 25 May 2025.

Copyright Notice

   Copyright (c) 2024 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction
   2.  Conventions and Definitions
   3.  The SRI Profile
     3.1.  Components and Parameters:
     3.2.  Structured Field Types
     3.3.  Retrieving the Key Material
     3.4.  Signature Algorithms
     3.5.  Determine Key/Algorithm Appropriateness
     3.6.  Derivation Context
     3.7.  Error Reporting from Verifier to Signer
   4.  Security Considerations
   5.  IANA Considerations
   6.  References
     6.1.  Normative References
     6.2.  Informative References
   Acknowledgments
   Author's Address

1.  Introduction

   This document defines an HTTP Message Signature profile that
   specifies the requirements for signatures intended as proofs of
   integrity/provenance that can be enforced upon by clients without any
   pre-existing relationship to the server which delivered them.  This
   requires locking down the components and properties of the signature
   itself, as well as some of the decision points available during the
   generation of the signature base (Section 2.5 of [RFC9421]).

   In short: this profile supports only Ed25519 signatures, requires
   that the public key portion of the verification key material be
   included in the signature's input, and specifies the ordering of the
   components and properties to remove potential ambiguity about the
   signature's construction.

2.  Conventions and Definitions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

3.  The SRI Profile

   The following requirements define a profile of HTTP Message
   Signatures that enables clients to verify a response's signature
   without any additional information, following the guidelines laid out
   in Section 1.4 of [RFC9421]:

3.1.  Components and Parameters:

   The signature's input MUST:

   1.  Include the following component identifiers (Section 2 of
       [RFC9421]) with their associated constraints:

       *  identity-digest, which MUST include the sf parameter
          (Section 2.1 of RFC9421}}) and no other parameters.

   2.  Include the following parameters (Section 2.3 of [RFC9421]) with
       their associated constraints:

       *  alg, whose value MUST be the string ed25519

       *  keyid, whose value MUST be a string containing an
          base64-encoding of the public key portion of the signature's
          verification key material.

       *  tag, whose value MUST be the string sri (or something more
          specific? enforce-ed25519-provenance?)

   3.  Order the signature's parameters alphabetically.

   The signature's input MAY:

   1.  Include the following parameters, with their associated
       constraints:

       *  created, an integer whose value MUST represent a time in the
          past.

       *  expires, an integer whose value MUST represent a time in the
          future.

3.2.  Structured Field Types

   The identity-digest component references the Identity-Digest header
   defined in [I-D.pardue-http-identity-digest].  It is expected to be a
   Dictionary Structured Field (Section 3.2 of [STRUCTURED-FIELDS]).

3.3.  Retrieving the Key Material

   The public key of the verification key material can be directly
   extracted from the signature input's keyid parameter, where it's
   represented as a base64-encoded string (Section 4 of [RFC4648]).

3.4.  Signature Algorithms

   The only signature algorithm allowed is ed25519.

3.5.  Determine Key/Algorithm Appropriateness

   Since the only accepted algorithm is ed25519, it is appropriate for
   any context in which this profile will be used, and we require it to
   be specified as the alg parameter to the signature's input.

3.6.  Derivation Context

   The context for derivation of message components from an HTTP message
   and its application context is the HTTP message itself, encompassing
   the response with which the signature was delivered, and the request
   to which it responds.

3.7.  Error Reporting from Verifier to Signer

   No error reporting is required.

   Clients MUST represent verification failures as network errors,
   consistent with [FETCH]'s handling of other server-specified
   constraints on the usage of response data.

4.  Security Considerations

   This profile has no security considerations beyond those specified in
   [RFC9421] itself, and in [SIGSRI] for which it serves as foundation.

5.  IANA Considerations

   This document has no IANA actions.

6.  References

6.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2119>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/rfc/rfc8174>.

   [RFC9421]  Backman, A., Ed., Richer, J., Ed., and M. Sporny, "HTTP
              Message Signatures", RFC 9421, DOI 10.17487/RFC9421,
              February 2024, <https://www.rfc-editor.org/rfc/rfc9421>.

6.2.  Informative References

   [FETCH]    Kesteren, A. van., "Fetch Standard", n.d.,
              <https://fetch.spec.whatwg.org/>.

   [I-D.pardue-http-identity-digest]
              Pardue, L., "HTTP Identity Digest", Work in Progress,
              Internet-Draft, draft-pardue-http-identity-digest-01, 7
              March 2023, <https://datatracker.ietf.org/doc/html/draft-
              pardue-http-identity-digest-01>.

   [RFC4648]  Josefsson, S., "The Base16, Base32, and Base64 Data
              Encodings", RFC 4648, DOI 10.17487/RFC4648, October 2006,
              <https://www.rfc-editor.org/rfc/rfc4648>.

   [SIGSRI]   West, M., "Signature-based SRI", n.d..

   [STRUCTURED-FIELDS]
              Nottingham, M. and P. Kamp, "Structured Field Values for
              HTTP", RFC 9651, DOI 10.17487/RFC9651, September 2024,
              <https://www.rfc-editor.org/rfc/rfc9651>.

Acknowledgments

   TODO acknowledge.

Author's Address

   Mike West
   Google, LLC.
   Email: mkwst@google.com
